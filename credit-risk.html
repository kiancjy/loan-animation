<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loan Process Animation</title>
  
  <!-- Satoshi Font -->
  <link href="https://api.fontshare.com/v2/css?f[]=satoshi@700,500,400&display=swap" rel="stylesheet">
  
  <!-- React and ReactDOM from CDN -->
  <script crossorigin src="https://unpkg.com/react@18.3.1/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18.3.1/umd/react-dom.production.min.js"></script>
  
  <!-- Framer Motion -->
  <script src="https://unpkg.com/framer-motion@12.5.0/dist/framer-motion.js"></script>
  
  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@0.475.0/dist/umd/lucide.min.js"></script>
  
  <!-- Babel for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <style>
    /* Reset styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    /* Base styles */
    :root {
      --blue-1: #000;
      --blue-2: #0b1316;
      --blue-3: #10262d;
      --blue-4: #11343f;
      --blue-5: #1d424d;
      --blue-6: #2c505c;
      --blue-7: #3e626e;
      --blue-8: #547985;
      --blue-9: #142a31;
      --blue-10: #1c404c;
      --blue-11: #9ac1cf;
      --blue-12: #c7eaf5;
      --green-primary: #3D9A50;
      --green-light: #DFFFD0;
      --red: #E52E3D;
      --white: #FFFFFF;
      --radius: 0.75rem;
    }
    
    html, body {
      font-family: 'Satoshi', sans-serif;
      width: 100%;
      height: 100%;
      background-color: transparent;
    }
    
    #root {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .loan-animation-container {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 300px;
      padding: 1rem;
      position: relative;
    }
    
    .loan-modal {
      background-color: var(--white);
      border: 1px solid var(--blue-7);
      border-radius: var(--radius);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
      width: 100%;
      max-width: 400px;
      padding: 2rem;
      text-align: center;
    }
    
    .progress-bar {
      width: 100%;
      height: 8px;
      background-color: rgba(16, 38, 45, 0.1);
      border-radius: 9999px;
      overflow: hidden;
      margin-bottom: 1rem;
    }
    
    .progress-bar-fill {
      height: 100%;
      border-radius: 9999px;
      transition: width 100ms ease-in-out;
    }
    
    .tick-circle {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background-color: var(--green-light);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1rem;
    }

    /* Responsive styles */
    @media (max-width: 480px) {
      .loan-modal {
        padding: 1.5rem;
      }
    }

    @media (max-width: 360px) {
      .loan-modal {
        padding: 1rem;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    // Import necessary components from React and Framer Motion
    const { useState, useEffect } = React;
    const { motion, AnimatePresence } = window.framerMotion;
    const { Check } = window.lucide;
    
    // Create LoanAnimation component
    const LoanAnimation = () => {
      // Default values for the animation
      const customerName = "John Doe";
      const loanAmount = "Â£5,000";
      
      const [stage, setStage] = useState("hidden");
      const [progress, setProgress] = useState(0);
      const [isVisible, setIsVisible] = useState(true);
    
      // Function to restart the animation cycle
      const restartAnimation = () => {
        setIsVisible(false);
        setTimeout(() => {
          setStage("loan");
          setProgress(0);
          setIsVisible(true);
        }, 1000);
      };
    
      // Initial animation cycle
      useEffect(() => {
        // Start with the loan modal after a short delay
        const initialDelay = setTimeout(() => {
          setStage("loan");
        }, 500);
    
        return () => clearTimeout(initialDelay);
      }, []);
    
      // Handle stage transitions
      useEffect(() => {
        let timer;
    
        if (stage === "loan") {
          // Show loan modal for 2 seconds, then transition to risk assessment
          timer = setTimeout(() => {
            setStage("risk");
          }, 2000);
        } 
        else if (stage === "risk") {
          // Simulate progress for risk assessment
          const interval = setInterval(() => {
            setProgress(prev => {
              if (prev >= 100) {
                clearInterval(interval);
                setTimeout(() => {
                  setStage("approved");
                }, 500);
                return 100;
              }
              return prev + 4; // Slightly faster progress
            });
          }, 100);
    
          return () => clearInterval(interval);
        }
        else if (stage === "approved") {
          // Show approved tick for 3 seconds, then restart
          timer = setTimeout(() => {
            setStage("restart");
          }, 3000);
        }
        else if (stage === "restart") {
          // Wait 1 second then restart the animation
          timer = setTimeout(() => {
            restartAnimation();
          }, 1000);
        }
    
        return () => {
          if (timer) clearTimeout(timer);
        };
      }, [stage]);
    
      if (!isVisible && stage === "restart") {
        return null;
      }
    
      // Function to interpolate between red and green based on progress
      const getProgressColor = (progress) => {
        // Starting color: #E52E3D (red)
        // Ending color: #3D9A50 (green)
        
        // Convert hex to RGB values
        const redStart = 229;    // E5 in hex
        const greenStart = 46;   // 2E in hex
        const blueStart = 61;    // 3D in hex
        
        const redEnd = 61;       // 3D in hex
        const greenEnd = 154;    // 9A in hex
        const blueEnd = 80;      // 50 in hex
        
        // Interpolate RGB values based on progress
        const r = Math.floor(redStart + (redEnd - redStart) * (progress / 100));
        const g = Math.floor(greenStart + (greenEnd - greenStart) * (progress / 100));
        const b = Math.floor(blueStart + (blueEnd - blueStart) * (progress / 100));
        
        return `rgb(${r}, ${g}, ${b})`;
      };
    
      return (
        <div className="loan-animation-container">
          <AnimatePresence mode="wait">
            {stage === "loan" && (
              <motion.div 
                className="loan-modal"
                initial={{ opacity: 0, y: 20, scale: 0.95 }}
                animate={{ 
                  opacity: 1, 
                  y: 0, 
                  scale: 1,
                  transition: { 
                    type: "spring", 
                    stiffness: 300, 
                    damping: 20
                  } 
                }}
                exit={{ 
                  opacity: 0, 
                  scale: 0.95, 
                  transition: { duration: 0.2 } 
                }}
                key="loan-modal"
              >
                <motion.h2 
                  style={{ 
                    fontSize: "1.5rem", 
                    marginBottom: "0.5rem", 
                    fontWeight: 700, 
                    color: "var(--blue-3)"
                  }}
                  initial={{ opacity: 0 }}
                  animate={{ opacity: 1, transition: { delay: 0.3 } }}
                >
                  Hello, {customerName}
                </motion.h2>
                <motion.p 
                  style={{ 
                    marginBottom: "1rem", 
                    color: "var(--blue-6)"
                  }}
                  initial={{ opacity: 0 }}
                  animate={{ opacity: 1, transition: { delay: 0.6 } }}
                >
                  Loan Requested:
                </motion.p>
                <motion.div 
                  style={{ 
                    fontSize: "1.875rem", 
                    marginBottom: "0.5rem", 
                    fontWeight: 700, 
                    color: "var(--blue-11)"
                  }}
                  initial={{ opacity: 0, y: 10 }}
                  animate={{ 
                    opacity: 1, 
                    y: 0, 
                    transition: { delay: 0.9 }
                  }}
                >
                  {loanAmount}
                </motion.div>
              </motion.div>
            )}
    
            {stage === "risk" && (
              <motion.div 
                className="loan-modal"
                initial={{ opacity: 0, scale: 0.9 }}
                animate={{ 
                  opacity: 1, 
                  scale: 1,
                  transition: { 
                    type: "spring",
                    stiffness: 300,
                    damping: 20
                  } 
                }}
                exit={{ 
                  opacity: 0, 
                  scale: 0.9, 
                  transition: { duration: 0.2 } 
                }}
                key="risk-modal"
              >
                <h2 
                  style={{ 
                    fontSize: "1.25rem", 
                    marginBottom: "1.5rem", 
                    fontWeight: 700, 
                    color: "var(--blue-3)"
                  }}
                >
                  Assessing Risk...
                </h2>
                <div className="progress-bar">
                  <div 
                    className="progress-bar-fill"
                    style={{ 
                      width: `${progress}%`,
                      backgroundColor: getProgressColor(progress) 
                    }}
                  />
                </div>
                <p 
                  style={{ 
                    fontSize: "0.875rem", 
                    color: "var(--blue-6)"
                  }}
                >
                  Analysing your request
                </p>
              </motion.div>
            )}
    
            {stage === "approved" && (
              <motion.div 
                className="loan-modal"
                initial={{ opacity: 0, scale: 0.9 }}
                animate={{ 
                  opacity: 1, 
                  scale: 1,
                  transition: { type: "spring", stiffness: 300, damping: 20 } 
                }}
                exit={{ opacity: 0, transition: { duration: 0.3 } }}
                key="approved-modal"
              >
                <motion.div 
                  style={{ display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center" }}
                  initial={{ opacity: 0 }}
                  animate={{ opacity: 1 }}
                >
                  <motion.div 
                    className="tick-circle"
                    initial={{ scale: 0 }}
                    animate={{ 
                      scale: 1,
                      transition: { 
                        type: "spring",
                        stiffness: 300,
                        damping: 15
                      }
                    }}
                  >
                    <Check color="var(--green-primary)" size={32} />
                  </motion.div>
                  <motion.h2 
                    style={{ 
                      fontSize: "1.25rem", 
                      fontWeight: 700, 
                      color: "var(--green-primary)" 
                    }}
                    initial={{ opacity: 0, y: 10 }}
                    animate={{ 
                      opacity: 1, 
                      y: 0,
                      transition: { delay: 0.2 }
                    }}
                  >
                    Approved
                  </motion.h2>
                </motion.div>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };
    
    // Render the component
    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<LoanAnimation />);
  </script>
</body>
</html>
